<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Fuyao-Jiang"><meta name="description" content="区块链开发、golang、智能合约、共识算法、密码学、Bitcoin、Ethereum、Bitshare源码解析、超级账本"><link rel="alternative" href="/atom.xml" title="姜富耀 | BlockChain" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>区块链开发 Solidity智能合约：入门篇 - 姜富耀 | BlockChain</title><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/js/fancybox/jquery.fancybox.min.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script src="/js/jquery-3.1.1.min.js"></script><script src="/js/fancybox/jquery.fancybox.min.js"></script></head><body style="opacity:0;"><header class="head"><h1 class="head-title u-fl"><a href="/">姜富耀 | BlockChain</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a class="head-nav__link" href="/archives">☯ DIR'/（目录）</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"> <time class="post__time" datetime="2018-02-05T13:36:43.000Z">二月 5, 2018</time><h1 class="post__title"><a href="/2018/02/05/区块链开发-Solidity智能合约：入门篇/">区块链开发 Solidity智能合约：入门篇</a></h1><div class="post__main echo"><blockquote>
<p>用 <code>Atom</code> 编辑器开发 以太坊Solidity智能合约。  </p>
</blockquote>
<p>安装<code>Atom</code>插件：  </p>
<p>autocomplete-solidity   自动补齐  </p>
<p>language-ethereum     代码高亮  </p>
<p>solidity官网  </p>
<p><a href="https://solidity.readthedocs.io/en/develop/" target="_blank" rel="noopener">https://solidity.readthedocs.io/en/develop/</a>  </p>
<h2 id="入门-Demo"><a href="#入门-Demo" class="headerlink" title="入门 Demo"></a>入门 Demo</h2><blockquote>
<p>用<code>Atom</code>新建 <code>001_demo.sol</code>文件。  </p>
</blockquote>
<p>开头第一句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.4.19;</span><br><span class="line">/*</span><br><span class="line">pragma 关键字</span><br><span class="line">soldity 代表当前语言</span><br><span class="line">0.4.19 代表solidity 版本</span><br><span class="line">^ 表示支持 向上兼容 0.4.19 ～ 0.4.99   0.4是大版本，最后一个数是小版本。</span><br><span class="line">不能兼容到 0.5.</span><br><span class="line">结尾一定要有分号</span><br><span class="line">当前版本 去 solidity 官网 查询</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>第一个 Demo：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">pragma  solidity ^0.4.19;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">属性</span><br><span class="line">行为</span><br><span class="line">构造函数</span><br><span class="line">普通函数</span><br><span class="line">get函数</span><br><span class="line">set函数</span><br><span class="line">析构函数</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">contract Dog &#123;</span><br><span class="line">  int internal age = 0; //年龄</span><br><span class="line"></span><br><span class="line">  //构造函数,在创建合约对象时，会先调用构造函数</span><br><span class="line">  //构造函数，函数名和类名相同</span><br><span class="line">  function Dog() public &#123;</span><br><span class="line">    age = 35;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /*</span><br><span class="line">  set方法，主要用于修改属性值</span><br><span class="line">  */</span><br><span class="line">  function setAge(int a) public &#123;</span><br><span class="line">    age = a;</span><br><span class="line">  &#125;</span><br><span class="line">  /*</span><br><span class="line">  读取属性值</span><br><span class="line">  */</span><br><span class="line">  function getAge() view public returns (int)  &#123;</span><br><span class="line"></span><br><span class="line">    return age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  //普通函数</span><br><span class="line">  /* function f() &#123;</span><br><span class="line"></span><br><span class="line">  &#125; */</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>编辑完，复制代码，到在线编译器，编译。</p>
</blockquote>
<p><code>https://ethereum.github.io/browser-solidity/</code>  </p>
<p>把代码粘贴到代码框，右边 点击<code>run</code> 选择 <code>JavaScript VM</code>  </p>
<p><img src="http://p37d7w3w4.bkt.clouddn.com/%E7%BC%96%E8%AF%911.png" alt="solidity">  </p>
<p>点击<code>Create</code>按钮 部署合约。  </p>
<p>点击下面的<code>getAge</code>，调用get方法，得到<code>35</code><br>在<code>setAge</code>中输入 <code>12</code>，点击<code>setAge</code><br>再点击<code>getAge</code>，变为<code>12</code></p>
<p><img src="http://p37d7w3w4.bkt.clouddn.com/%E7%BC%96%E8%AF%912.png" alt="">  </p>
<blockquote>
<p>调用msg.sender 得到当前操作合约者的地址  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">pragma  solidity ^0.4.19;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">contract C &#123;</span><br><span class="line"></span><br><span class="line">/* address 相当于 uint160</span><br><span class="line"></span><br><span class="line">   function 函数关键字</span><br><span class="line">   getCourrentAdd 函数名</span><br><span class="line">   returns (address) 有返回值，返回值类型为address </span><br><span class="line">*/</span><br><span class="line">  </span><br><span class="line">  function getCourrentAdd() view public returns (address) &#123;</span><br><span class="line">    </span><br><span class="line">      // msg.sender 正在操作合约的钱包地址，不一定是部署合约的人的地址</span><br><span class="line">      return msg.sender;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同样，在<code>atom</code>中写完代码，复制到网页编译器，点击<code>Run</code>菜单、<code>Create</code>部署。<br>部署完了，下面出现<code>getCourrentAdd</code>按钮,怼它一下，出现 正在操作智能合约的以太坊地址，就是你。  </p>
<p><img src="http://p37d7w3w4.bkt.clouddn.com/%E7%BC%96%E8%AF%913.png" alt=""></p>
<blockquote>
<p>析构函数 (销毁)  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">pragma  solidity ^0.4.19;</span><br><span class="line"></span><br><span class="line">contract C &#123;</span><br><span class="line">    uint age = 0; //属性</span><br><span class="line"></span><br><span class="line">    // 构造函数</span><br><span class="line">    function C() public &#123;</span><br><span class="line">      age = 30; //初始化属性的值</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 通过set方法修改age的值</span><br><span class="line">    function setAge(uint a) public  &#123;</span><br><span class="line">      age = a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 返回属性age的值</span><br><span class="line">    function getAge() view public returns (uint) &#123;</span><br><span class="line">      return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // kill只是一个普通函数而已</span><br><span class="line">    // selfdestruct 是析构函数，当析构函数一旦被调用，对象就会被销毁</span><br><span class="line">    </span><br><span class="line">    function kill() public &#123;</span><br><span class="line">      //析构函数</span><br><span class="line">      selfdestruct(msg.sender);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>点击<code>Create</code>部署，下面多出个<code>kill</code>按钮，先点击<code>getAge</code>可以得到<code>35</code>，然后再点<code>kill</code>调用析构函数，销毁合约，然后再点<code>getAge</code> 提示错误：  </p>
<p><img src="http://p37d7w3w4.bkt.clouddn.com/%E7%BC%96%E8%AF%914.png" alt="">  </p>
<blockquote>
<p>但是上面案例 谁都能 销毁合约，如何只让 部署合约的地址拥有调用析构函数，销毁合约？  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">pragma  solidity ^0.4.19;</span><br><span class="line"></span><br><span class="line">contract C &#123;</span><br><span class="line">    uint age = 0; //属性</span><br><span class="line">    address owner;</span><br><span class="line">    // 构造函数</span><br><span class="line">    // 创建合约对象时，仅调用一次</span><br><span class="line"></span><br><span class="line">    function C() public &#123;</span><br><span class="line">      age = 30; //初始化属性的值</span><br><span class="line">      owner = msg.sender; //将部署合约的人的地址保存下来</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 通过set方法修改age的值</span><br><span class="line">    function setAge(uint a) public  &#123;</span><br><span class="line">      age = a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 返回属性age的值</span><br><span class="line">    function getAge() view public returns (uint) &#123;</span><br><span class="line">      return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // kill只是一个普通函数而已</span><br><span class="line">    // selfdestruct 是析构函数，当析构函数一旦被调用，对象就会被销毁</span><br><span class="line">    </span><br><span class="line">    function kill() public &#123;</span><br><span class="line">      </span><br><span class="line">      // 判断当前正在操作合约的人是否是创建人</span><br><span class="line">      // owner 创建合约的人</span><br><span class="line">      // msg.sender 正在操作合约的人</span><br><span class="line">      </span><br><span class="line">      if (owner == msg.sender) &#123;</span><br><span class="line">        //析构函数</span><br><span class="line">        selfdestruct(msg.sender);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  部署，然后切换到 别的 地址 ，调用 <code>kill</code>，然后<code>getAge</code>发现还能得到结果，但用 部署合约的地址 按<code>kill</code>按钮，再点<code>getAge</code>发现报错，说明销毁。  </p>
<p>  <img src="http://p37d7w3w4.bkt.clouddn.com/%E7%BC%96%E8%AF%915.png" alt="">  </p>
<h2 id="public、private-和-internal-类型比较"><a href="#public、private-和-internal-类型比较" class="headerlink" title="public、private 和 internal 类型比较"></a>public、private 和 internal 类型比较</h2><blockquote>
<p>属性的访问权限： </p>
</blockquote>
<p><strong>public</strong> : </p>
<p>1.生成一个和属性名同名的get方法，这个函数返回属性自己。<br>2.合约内部能够直接访问属性。<br>3.子类能够继承属性。  </p>
<p><strong>internal</strong>：<br>1.合约内部能够直接访问属性。<br>2.子类能够继承属性。  </p>
<p><strong>private</strong>：<br>1.合约内部能够直接访问属性。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.4.19;</span><br><span class="line"></span><br><span class="line">contract Person &#123;</span><br><span class="line">  </span><br><span class="line">  // public  intenal private  三种类型。</span><br><span class="line">  // age 默认为 internal ,受保护类型</span><br><span class="line">  uint age = 40; //属性，初始值为40</span><br><span class="line">  </span><br><span class="line">  // 显式添加internal 合约内部、子类能访问</span><br><span class="line">  string internal name = &quot;jiangfuyao&quot;;</span><br><span class="line">  </span><br><span class="line">  // public 公有，会自动生成 get方法，那么外部，合约内部、合约子类都能访问。</span><br><span class="line">  string public homeAddress = &quot;北京市海淀区&quot;;</span><br><span class="line">  </span><br><span class="line">  // private 私有，只能合约内部使用，子类和外部不行。</span><br><span class="line">  string private company = &quot;孔壹学院&quot;;</span><br><span class="line">  </span><br><span class="line">  function test() private &#123;</span><br><span class="line">    age = 23;</span><br><span class="line">    name = &quot;sdf&quot;;</span><br><span class="line">    homeAddress = &quot;中国&quot;;</span><br><span class="line">    company = &quot;从零到一&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract ChildPerson is Person &#123;</span><br><span class="line">    function test1() public &#123;</span><br><span class="line">        age = 100;</span><br><span class="line">        name = &quot;jiangyaofu&quot;;</span><br><span class="line">        homeAddress = &quot;changpping&quot;;</span><br><span class="line">       // company = &quot;cong lingdaoyi&quot;; private 类型无法被子类调用</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>选择<code>ChildPerson</code>进行部署，点击<code>homeAddress</code>发现继承了<code>Person</code>父类的属性得到<code>北京市海淀区</code>。  </p>
<p><img src="http://p37d7w3w4.bkt.clouddn.com/%E7%BC%96%E8%AF%916.png" alt="">  </p>
<hr>
<blockquote>
<p><strong><em>日后随着 学习打怪的不断深入，会解锁其他的高级教程。</em></strong>  </p>
<h3 id="期待-吗？-那就关注下面-公众号-随时锁定区块链开发学习教程进度-："><a href="#期待-吗？-那就关注下面-公众号-随时锁定区块链开发学习教程进度-：" class="headerlink" title="期待 吗？ 那就关注下面 公众号 随时锁定区块链开发学习教程进度 ：)"></a><strong><em>期待 吗？ 那就关注下面 公众号 随时锁定区块链开发学习教程进度 ：)</em></strong></h3></blockquote>
</div></header><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a class="post__tag__link" href="/tags/Solidity/">Solidity</a></li></ul></footer></article><section class="reward"><a class="btn-reward" href="#">关注公众号</a><div class="reward-wrapper clearfix"><img src="/img/wechat.jpg" title="公众号：区块链开发技术共享"><img src="/img/lianhu.jpg" title="公众号：区块链部落"></div></section><div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC8zMzU4MC8xMDEzNQ=="><script>(function(d, s) {var j, e = d.getElementsByTagName(s)[0];if (typeof LivereTower === 'function') { return; } j = d.createElement(s);j.src = 'https://cdn-city.livere.com/js/embed.dist.js';j.async = true;e.parentNode.insertBefore(j, e);})(document, 'script');</script></div></main><footer class="foot"><div class="foot-copy">&copy; 2018 Fuyao-Jiang</div></footer><script src="/js/scroller.js"></script><script src="/js/main.js"></script></body></html>